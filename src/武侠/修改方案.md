ä¼˜åŒ–ä»»åŠ¡è¯¦æƒ…æ–‡æ¡£
ä»¥ä¸‹æ˜¯4ä¸ªç‹¬ç«‹çš„ä¼˜åŒ–ä»»åŠ¡ï¼Œä½ å¯ä»¥åœ¨æ–°çª—å£ä¸­åˆ†åˆ«æ‰§è¡Œï¼š

ä»»åŠ¡ 1: æ‹†åˆ† GamePanels.tsxï¼ˆ932è¡Œâ†’ 6ä¸ªæ–‡ä»¶ï¼‰
å½“å‰é—®é¢˜ï¼š

GamePanels.tsx åŒ…å«6ä¸ªç‹¬ç«‹é¢æ¿ç»„ä»¶ï¼Œå…±932è¡Œ
è¿åå•ä¸€èŒè´£åŸåˆ™ï¼Œéš¾ä»¥ç»´æŠ¤
å½“å‰ç»“æ„ï¼š

GamePanels.tsx (932è¡Œ)
â”œâ”€â”€ EmptyState (18-25è¡Œ) - å…±ç”¨ç©ºçŠ¶æ€ç»„ä»¶
â”œâ”€â”€ CharacterPanel (27-309è¡Œ) - è§’è‰²é¢æ¿~280è¡Œ
â”œâ”€â”€ MartialArtsPanel (311-543è¡Œ) - åŠŸæ³•é¢æ¿ ~230è¡Œ
â”œâ”€â”€ StatBar, Attribute (545-567è¡Œ) - è¾…åŠ©ç»„ä»¶
â”œâ”€â”€ InventoryPanel (570-695è¡Œ) - èƒŒåŒ…é¢æ¿ ~125è¡Œ
â”œâ”€â”€ EventsPanel (697-776è¡Œ) - äº‹ä»¶é¢æ¿ ~80è¡Œ
â”œâ”€â”€ SocialPanel (778-921è¡Œ) - ç¤¾äº¤é¢æ¿ ~145è¡Œ
â””â”€â”€ MapPanel (923-932è¡Œ) - åœ°å›¾é¢æ¿ ~10è¡Œ
ä¼˜åŒ–æ–¹æ¡ˆï¼š

src/æ­¦ä¾ /components/panels/
â”œâ”€â”€ index.ts# ç»Ÿä¸€å¯¼å‡º
â”œâ”€â”€ EmptyState.tsx        # å…±ç”¨ç©ºçŠ¶æ€ç»„ä»¶
â”œâ”€â”€ CharacterPanel.tsx    # è§’è‰²é¢æ¿
â”œâ”€â”€ MartialArtsPanel.tsx  # åŠŸæ³•é¢æ¿
â”œâ”€â”€ InventoryPanel.tsx    # èƒŒåŒ…é¢æ¿
â”œâ”€â”€ EventsPanel.tsx       # äº‹ä»¶é¢æ¿
â”œâ”€â”€ SocialPanel.tsx       # ç¤¾äº¤é¢æ¿
â””â”€â”€ MapPanel.tsx          # åœ°å›¾é¢æ¿
æ‰§è¡Œæ­¥éª¤ï¼š

åˆ›å»º src/æ­¦ä¾ /components/panels/ ç›®å½•
å°† EmptyState æå–åˆ° EmptyState.tsx
å°† StatBar å’Œ Attribute æå–åˆ° CharacterPanel.tsx å†…éƒ¨ï¼ˆä»…è¯¥ç»„ä»¶ä½¿ç”¨ï¼‰
å°†æ¯ä¸ªé¢æ¿ç»„ä»¶æå–åˆ°ç‹¬ç«‹æ–‡ä»¶
åˆ›å»º index.ts ç»Ÿä¸€å¯¼å‡º
æ›´æ–° App.tsx çš„å¯¼å…¥è·¯å¾„
æ³¨æ„äº‹é¡¹ï¼š

QUALITY_CONFIGã€getActionLabelã€getItemTypeLabelã€getItemQualityInfo æ˜¯InventoryPanel çš„ç§æœ‰è¾…åŠ©å‡½æ•°ï¼Œåº”ä¿ç•™åœ¨ InventoryPanel.tsx å†…
getRankColorã€getMasteryColor æ˜¯ MartialArtsPanel çš„ç§æœ‰å‡½æ•°
ä»»åŠ¡ 2: æ‹†åˆ† App.tsxï¼ˆ854è¡Œ â†’ æå–è‡ªå®šä¹‰ hooksï¼‰
å½“å‰é—®é¢˜ï¼š

App.tsx åŒ…å«854è¡Œä»£ç ï¼ŒçŠ¶æ€ç®¡ç†é€»è¾‘è¿‡é‡
104ä¸ª hooks è°ƒç”¨æ··æ‚åœ¨ä¸€èµ·
346ä¸ª consoleè¯­å¥ï¼ˆè°ƒè¯•æ—¥å¿—ï¼‰
å½“å‰çŠ¶æ€åˆ†å¸ƒï¼š

// é¡µé¢æµç¨‹çŠ¶æ€ (90-92è¡Œ)
const [currentPage, setCurrentPage] = useState<PageState>('start');
const [savedGameExists, setSavedGameExists] = useState(false);
const [isLoading, setIsLoading] = useState(false);

// æ¸¸æˆçŠ¶æ€ (98-106è¡Œ)
const [gameState, setGameState] = useState<GameState>(DEFAULT_GAME_STATE);
const [activePanel, setActivePanel] = useState<ActivePanel>(ActivePanel.NONE);
const [currentMaintext, setCurrentMaintext] = useState<string>('');
const [currentOptions, setCurrentOptions] = useState<string[]>([]);

// æ˜¾ç¤ºè®¾ç½® (109-115è¡Œ)
const [displaySettings, setDisplaySettings] = useState<DisplaySettings>(...);
const [toastState, setToastState] = useState<ToastState>(...);
const [debugLogs, setDebugLogs] = useState<DebugLogEntry[]>([]);
ä¼˜åŒ–æ–¹æ¡ˆï¼š

src/æ­¦ä¾ /hooks/
â”œâ”€â”€ useGameState.ts       # æ¸¸æˆçŠ¶æ€ç®¡ç† (gameState, readGameData)
â”œâ”€â”€ usePageFlow.ts        # é¡µé¢æµç¨‹ (currentPage, handleStart, handleNewGame...)
â”œâ”€â”€ useMessageHandler.ts  # æ¶ˆæ¯å‘é€å¤„ç† (handleSendMessage)
â”œâ”€â”€ useEventListeners.ts  # äº‹ä»¶ç›‘å¬ (MESSAGE_RECEIVED, CHAT_CHANGED, era:writeDone)
â”œâ”€â”€ useDebugLogs.ts       # è°ƒè¯•æ—¥å¿— (debugLogs, addDebugLog, clearDebugLogs)
â””â”€â”€ index.ts              # ç»Ÿä¸€å¯¼å‡º
æå–ç¤ºä¾‹ - useDebugLogs.tsï¼š

import { useCallback, useState } from 'react';

export interface DebugLogEntry {
  id: string;
  timestamp: Date;
  type: 'prompt' | 'assistant';
  content: string;
}

export function useDebugLogs() {
  const [debugLogs, setDebugLogs] = useState<DebugLogEntry[]>([]);

  const addDebugLog = useCallback((type: 'prompt' | 'assistant', content: string) => {
    const newLog: DebugLogEntry = {
      id: `${Date.now()}-${Math.random().toString(36).substr(2, 9)}`,
      timestamp: new Date(),
      type,
      content,
    };
    setDebugLogs(prev => [...prev, newLog]);
  }, []);

  const clearDebugLogs = useCallback(() => {
    setDebugLogs([]);
  }, []);

  return { debugLogs, addDebugLog, clearDebugLogs };
}
æ‰§è¡Œæ­¥éª¤ï¼š

åˆ›å»º src/æ­¦ä¾ /hooks/ ç›®å½•
æå– useDebugLogs hookï¼ˆæœ€ç®€å•ï¼Œå…ˆåšï¼‰
æå– usePageFlow hookï¼ˆé¡µé¢æµç¨‹çŠ¶æ€å’Œå¤„ç†å‡½æ•°ï¼‰
æå– useGameState hookï¼ˆæ¸¸æˆçŠ¶æ€è¯»å–å’Œæ›´æ–°ï¼‰
æå– useEventListeners hookï¼ˆäº‹ä»¶ç›‘å¬é€»è¾‘ï¼‰
æå– useMessageHandler hookï¼ˆæ¶ˆæ¯å‘é€é€»è¾‘ï¼‰
æ›´æ–° App.tsx ä½¿ç”¨æ–° hooks
ä»»åŠ¡ 3: æ·»åŠ è°ƒè¯•æ—¥å¿—å¼€å…³ï¼ˆæ¸…ç†346ä¸ª console è¯­å¥ï¼‰
å½“å‰é—®é¢˜ï¼š

App.tsx ä¸­æœ‰346ä¸ª console.log / console.error è¯­å¥
ç”Ÿäº§ç¯å¢ƒä¸éœ€è¦è¿™äº›æ—¥å¿—ï¼Œå½±å“æ€§èƒ½å’Œä»£ç æ•´æ´åº¦
console è¯­å¥åˆ†å¸ƒï¼š

App.tsx:

- åˆå§‹åŒ–æµç¨‹: ~30ä¸ª
- handleMessageUpdate: ~20ä¸ª
- handleSendMessage: ~80ä¸ª
- handleSetupSubmit: ~15ä¸ª
- handleContinue: ~10ä¸ª
- å…¶ä»–: ~10ä¸ª
ä¼˜åŒ–æ–¹æ¡ˆ A - ç®€å•æ–¹æ¡ˆï¼ˆç¯å¢ƒå˜é‡å¼€å…³ï¼‰ï¼š

// src/æ­¦ä¾ /utils/logger.ts
const DEBUG = process.env.NODE_ENV === 'development';

export const logger = {
  log: DEBUG ? console.log.bind(console) : () => {},
  error: DEBUG ? console.error.bind(console) : () => {},
  warn: DEBUG ? console.warn.bind(console) : () => {},
  group: DEBUG ? console.group.bind(console) : () => {},
  groupEnd: DEBUG ? console.groupEnd.bind(console) : () => {},
};
ä¼˜åŒ–æ–¹æ¡ˆ B - è¿›é˜¶æ–¹æ¡ˆï¼ˆåˆ†ç±»æ—¥å¿—ï¼‰ï¼š

// src/æ­¦ä¾ /utils/logger.ts
type LogCategory = 'init' | 'message' | 'event' | 'game' | 'api';

const DEBUG_CATEGORIES: Record<LogCategory, boolean> = {
  init: true,
  message: true,
  event: true,
  game: true,
  api: true,
};

export function createLogger(category: LogCategory) {
  const enabled = process.env.NODE_ENV === 'development' && DEBUG_CATEGORIES[category];
  const prefix = `[${category.toUpperCase()}]`;
  
  return {
    log: enabled ? (...args: unknown[]) => console.log(prefix, ...args) : () => {},
    error: enabled ? (...args: unknown[]) => console.error(prefix, ...args) : () => {},};
}

// ä½¿ç”¨ç¤ºä¾‹
const initLogger = createLogger('init');
initLogger.log('ğŸ® åˆå§‹åŒ–å¼€å§‹...');
æ‰§è¡Œæ­¥éª¤ï¼š

åˆ›å»º src/æ­¦ä¾ /utils/logger.ts
åœ¨ App.tsx ä¸­å¯¼å…¥ logger
æ‰¹é‡æ›¿æ¢ console.log â†’ logger.log
æ‰¹é‡æ›¿æ¢ console.error â†’ logger.error
å¯é€‰ï¼šä¸ºä¸åŒæ¨¡å—åˆ›å»ºåˆ†ç±» logger
ä»»åŠ¡ 4: æ‹†åˆ† _setup.scssï¼ˆ3861è¡Œ â†’ æŒ‰æ­¥éª¤æ‹†åˆ†ï¼‰
å½“å‰é—®é¢˜ï¼š

_setup.scss åŒ…å«3861è¡Œæ ·å¼ä»£ç 
7æ­¥å¼€å±€æµç¨‹çš„æ ·å¼å…¨éƒ¨æ··åˆåœ¨ä¸€èµ·
å½“å‰ç»“æ„ï¼ˆæ ¹æ®æ–‡ä»¶å†…å®¹æ¨æ–­ï¼‰ï¼š

// _setup.scss åŒ…å«ï¼š
// 1. ä¸»å®¹å™¨æ ·å¼ (.setup-screen)
// 2. åŠ¨æ€èƒŒæ™¯å±‚ (.setup-bg-*)
// 3. æ­¥éª¤æŒ‡ç¤ºå™¨ (.setup-steps)
// 4. å¤©èµ„é€‰æ‹©æ­¥éª¤æ ·å¼
// 5. å±æ€§åˆ†é…æ­¥éª¤æ ·å¼
// 6. å¤©èµ‹é€‰æ‹©æ­¥éª¤æ ·å¼
// 7. æ­¦åŠŸé€‰æ‹©æ­¥éª¤æ ·å¼
// 8. å‡ºèº«é€‰æ‹©æ­¥éª¤æ ·å¼
// 9. èº«ä»½è®¾ç½®æ­¥éª¤æ ·å¼
// 10. ç¡®è®¤ä¿å­˜æ­¥éª¤æ ·å¼
// 11. æŠ½å¡ç³»ç»Ÿæ ·å¼
// 12. åŠ¨ç”»å®šä¹‰
ä¼˜åŒ–æ–¹æ¡ˆï¼š

src/æ­¦ä¾ /styles/setup/
â”œâ”€â”€ _index.scss           # å…¥å£æ–‡ä»¶ï¼Œå¯¼å…¥æ‰€æœ‰å­æ¨¡å—
â”œâ”€â”€_base.scss            # ä¸»å®¹å™¨ã€èƒŒæ™¯å±‚ã€é€šç”¨æ ·å¼
â”œâ”€â”€ _steps-indicator.scss # æ­¥éª¤æŒ‡ç¤ºå™¨
â”œâ”€â”€_step-talent.scss     # å¤©èµ„é€‰æ‹©
â”œâ”€â”€ _step-attributes.scss # å±æ€§åˆ†é…
â”œâ”€â”€_step-traits.scss     # å¤©èµ‹é€‰æ‹©
â”œâ”€â”€ _step-martial.scss    # æ­¦åŠŸé€‰æ‹©
â”œâ”€â”€_step-origin.scss     # å‡ºèº«é€‰æ‹©
â”œâ”€â”€ _step-identity.scss   # èº«ä»½è®¾ç½®
â”œâ”€â”€_step-confirm.scss    # ç¡®è®¤ä¿å­˜
â”œâ”€â”€ _gacha.scss           # æŠ½å¡ç³»ç»Ÿ
â””â”€â”€_animations.scss      # åŠ¨ç”»å®šä¹‰
å…¥å£æ–‡ä»¶ç¤ºä¾‹ - _index.scssï¼š

// Setup Screen æ ·å¼æ¨¡å—
@import 'base';
@import 'steps-indicator';
@import 'step-talent';
@import 'step-attributes';
@import 'step-traits';
@import 'step-martial';
@import 'step-origin';
@import 'step-identity';
@import 'step-confirm';
@import 'gacha';
@import 'animations';
æ›´æ–° main.scssï¼š

// åŸæ¥
@import 'setup';

// æ”¹ä¸º
@import 'setup/index';
æ‰§è¡Œæ­¥éª¤ï¼š

åˆ›å»º src/æ­¦ä¾ /styles/setup/ ç›®å½•
åˆ†æ _setup.scss çš„ç»“æ„ï¼Œè¯†åˆ«å„éƒ¨åˆ†è¾¹ç•Œ
æŒ‰åŠŸèƒ½æ¨¡å—æ‹†åˆ†åˆ°ç‹¬ç«‹æ–‡ä»¶
åˆ›å»º_index.scss ç»Ÿä¸€å¯¼å…¥
æ›´æ–° main.scss çš„å¯¼å…¥è·¯å¾„
åˆ é™¤åŸ_setup.scss

æ‰§è¡Œå»ºè®®
ä»»åŠ¡ éš¾åº¦ é¢„è®¡å·¥ä½œé‡ å»ºè®®é¡ºåº
ä»»åŠ¡ 3: è°ƒè¯•æ—¥å¿—å¼€å…³ â­ ç®€å• å° 1 (æœ€å¿«è§æ•ˆ)
ä»»åŠ¡ 1: æ‹†åˆ† GamePanels â­â­ ä¸­ç­‰ ä¸­ 2
ä»»åŠ¡ 2: æ‹†åˆ† App.tsx hooks â­â­â­ è¾ƒéš¾ å¤§ 3
ä»»åŠ¡ 4: æ‹†åˆ†_setup.scss â­â­ ä¸­ç­‰ ä¸­ 4
æ¯ä¸ªä»»åŠ¡éƒ½æ˜¯ç‹¬ç«‹çš„ï¼Œå¯ä»¥åœ¨æ–°çª—å£ä¸­å¹¶è¡Œæ‰§è¡Œã€‚
