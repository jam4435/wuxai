// =========================================
// Layout Containers
// =========================================

.app-container {
  display: flex;
  flex-direction: column; // Mobile: Top/Bottom split
  width: 100%;
  height: var(--TH-viewport-height, 100vh);
  min-height: var(--TH-viewport-height, 100vh);
  max-height: var(--TH-viewport-height, 100vh);
  background-color: var(--bg-dark);
  color: var(--stone-200);
  position: relative;
  overflow: hidden;

  @media (min-width: 768px) {
    flex-direction: row; // Desktop: Left/Right split
  }
}

.max-w-1920 {
  max-width: 1920px;
  margin: 0 auto;
  width: 100%;
  height: 100%;
  display: flex;
  flex-direction: column;
  position: relative;
  z-index: 10;
  overflow: hidden;

  @media (min-width: 768px) {
    flex-direction: row;
    height: 100%;
  }
}

// =========================================
// Background Layer - 武侠风格优化版
// =========================================

.bg-layer {
  position: absolute;
  inset: 0;
  z-index: 0;
  pointer-events: none;
  overflow: hidden;
  // 性能优化：使用 GPU 加速
  will-change: opacity;
  transform: translateZ(0);
}

.bg-img {
  position: absolute;
  inset: 0;
  background-size: cover;
  background-position: center;
  transition: opacity 1s ease;
  opacity: 0.15;
  transform: scale(1.02);
  background-image: url('https://images.unsplash.com/photo-1534067783941-51c9c23ecefd?q=80&w=1920&auto=format&fit=crop&blur=10');
  filter: grayscale(60%) sepia(20%);
  // 性能优化
  will-change: transform, opacity;
}

.bg-gradient-vert {
  position: absolute;
  inset: 0;
  background: linear-gradient(
    to bottom,
    var(--bg-dark) 0%,
    rgba(12, 10, 9, 0.7) 20%,
    transparent 50%,
    rgba(12, 10, 9, 0.7) 80%,
    var(--bg-dark) 100%
  );
}

.bg-radial {
  position: absolute;
  inset: 0;
  background: radial-gradient(ellipse at 50% 30%, transparent 0%, rgba(12, 10, 9, 0.5) 40%, var(--bg-dark) 100%);
  opacity: 0.9;
}

// 武侠风格装饰性背景元素
.bg-vignette {
  position: absolute;
  inset: 0;
  background: radial-gradient(ellipse at center, transparent 50%, rgba(0, 0, 0, 0.4) 100%);
  pointer-events: none;
}

// 微妙的纹理叠加（可选）
.bg-texture {
  position: absolute;
  inset: 0;
  opacity: 0.03;
  background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E");
  pointer-events: none;
}

// =========================================
// Main Content Column
// =========================================

.main-column {
  order: 1;
  flex: 1;
  display: flex;
  flex-direction: column;
  height: 100%;
  min-height: 0; // 重要：允许 flex 子元素收缩
  position: relative;
  overflow: hidden;

  @media (min-width: 768px) {
    order: 2;
    // 桌面端：计算高度减去可能的边距
    height: 100%;
  }
}

// =========================================
// 全局滚动条样式 - 武侠风格
// =========================================

// 应用于所有滚动区域
*::-webkit-scrollbar {
  width: 8px;
  height: 8px;
}

*::-webkit-scrollbar-track {
  background: rgba(28, 25, 23, 0.5);
  border-radius: 4px;
}

*::-webkit-scrollbar-thumb {
  background: linear-gradient(
    180deg,
    rgba(139, 90, 43, 0.5) 0%,
    rgba(181, 137, 80, 0.4) 50%,
    rgba(139, 90, 43, 0.5) 100%
  );
  border-radius: 4px;
  border: 1px solid rgba(139, 90, 43, 0.2);
  transition: background 0.3s ease;

  &:hover {
    background: linear-gradient(
      180deg,
      rgba(181, 137, 80, 0.7) 0%,
      rgba(212, 175, 55, 0.5) 50%,
      rgba(181, 137, 80, 0.7) 100%
    );
    border-color: rgba(181, 137, 80, 0.4);
  }
}

*::-webkit-scrollbar-corner {
  background: rgba(28, 25, 23, 0.5);
}

// Firefox 滚动条样式
* {
  scrollbar-width: thin;
  scrollbar-color: rgba(139, 90, 43, 0.5) rgba(28, 25, 23, 0.5);
}

// =========================================
// Fullscreen Support
// =========================================

/* 全屏模式下的样式调整 */
html:fullscreen,
html:-webkit-full-screen,
html:-moz-full-screen,
html:-ms-fullscreen {
  #root,
  .app-container,
  .start-screen,
  .splash-screen,
  .setup-screen {
    width: 100vw !important;
    height: 100vh !important;
    min-height: 100vh !important;
  }
}

/* 全屏按钮样式 */
.fullscreen-btn {
  position: fixed;
  top: 1rem;
  right: 1rem;
  z-index: 100;
  background: rgba(0, 0, 0, 0.5);
  border: 1px solid var(--stone-700);
  color: var(--stone-400);
  padding: 0.5rem;
  cursor: pointer;
  transition: all 0.2s;
  display: flex;
  align-items: center;
  justify-content: center;

  &:hover {
    background: rgba(0, 0, 0, 0.7);
    border-color: var(--yellow-800);
    color: var(--yellow-600);
  }
}

/* 页面特定位置调整 */
.splash-fullscreen-btn {
  position: absolute;
  top: 1.5rem;
  right: 1.5rem;
}

.header-fullscreen-btn {
  position: relative;
  top: auto;
  right: auto;
  margin-left: 0.75rem;
}
